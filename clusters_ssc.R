library(varclust)
library(dplyr)
library(tidyr)
library(readr)
library(stringr)
library(ggplot2)
library(ggmap)
load("data/march_less.rda")
load("data/march_daily.rda")
source("functions.R")

cl1 <- c(NaN,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,NaN,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
         1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1)
cl2 <- c(NaN,1,1,2,2,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1,1,2,2,2,2,1,1,1,1,1,1,1,1,2,2,2,2,1,1,2,2,2,2,1,1,2,2,2,1,1,1,2,2,2,2,1,1,1,1,1,1,1,1,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,2,1,1,2,2,2,2,1,1,1,1,1,1,1,1,2,2,2,1,1,1,2,2,2,2,1,1,2,2,2,2,1,1,2,2,2,1,1,1,2,2,2,1,1,1,2,2,2,2,1,1,1,1,1,1,1,2,2,2,2,1,1,2,2,2,2,1,1,2,2,2,2,1,1,1,1,1,2,1,1,2,2,2,1,1,1,2,2,2,1,1,1,2,2,2,2,1,1,2,2,2,1,1,1,1,1,1,1,1,1,2,2,2,2,1,1,2,2,2,2,1,1,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,1,1,2,2,2,1,1,1,2,2,2,2,1,1,1,1,1,
         1,1,2,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,2,1,1,1)
# Dla cl1 i cl2 wyszły NaN na pierwszym miejscu, zmieniłem na 1, żeby wyszło cokolwiek, bo warto
cl3 <- c(3,2,2,1,1,1,2,2,2,2,2,2,3,2,2,2,2,2,3,2,2,1,1,1,3,2,2,3,3,3,3,2,2,1,1,1,3,2,2,1,1,1,3,2,2,1,1,1,3,2,2,1,1,1,3,2,2,2,2,2,3,2,2,1,1,1,3,2,2,2,2,2,3,2,2,2,2,2,3,2,2,1,1,1,3,2,2,2,2,2,3,2,2,1,1,1,3,2,2,1,1,1,3,2,2,1,1,1,3,2,2,1,1,1,3,2,2,1,1,1,3,2,2,1,1,1,3,2,2,2,2,2,3,2,1,1,1,3,2,2,1,1,1,3,2,2,1,1,1,3,2,2,2,2,2,3,2,2,1,1,1,3,2,2,1,1,1,3,2,2,1,1,1,3,2,2,1,1,1,3,2,2,2,2,2,3,2,2,1,1,1,3,2,2,1,1,1,3,2,2,1,1,1,3,2,2,2,2,2,3,2,2,2,2,2,3,2,2,2,2,2,3,2,2,2,2,2,3,2,2,2,2,2,3,2,2,2,2,2,3,2,2,1,1,1,3,2,2,1,1,1,3,2,2,1,1,1,3,2,2,2,2,2,
         3,3,1,2,2,2,2,2,2,2,2,2,3,3,1,2,2,2,3,3,1,2,2,2,3,3,1,2,2,2,3,3,1,2,2,2,3,3,1,2,2,2,3,3,1,2,2,2,3,3,1,2,2,2,3,3,1,2,2,2,3,3,1,2,2,2,3,3,1,2,2,2,3,3,1,2,2,2,3,3,1,2,2,2,3,3,1,2,2,2,3,3,1,2,2,2,3,3,1,2,2,2,3,3,1,2,2,2,3,3,1,2,2,2,3,3,1,2,2,2,3,3,1,2,2,2,3,3,1,2,2,2,3,3,2,2,2,3,3,1,2,2,2,3,3,1,2,2,2,3,3,1,2,2,2,3,3,1,2,2,2,3,3,1,2,2,2,3,3,1,2,2,2,3,3,1,2,2,2,3,3,1,2,2,2,3,3,1,2,2,2,3,3,1,2,2,2,3,3,1,2,2,2,3,3,1,2,2,2,3,3,1,2,2,2,3,3,1,2,2,2,3,3,1,2,2,2,3,3,1,2,2,2,3,3,1,2,2,2,3,3,1,2,2,2,3,3,1,2,2,2,3,3,1,2,2,2,3,3,1,2,2,2)
cl4 <- c(1,3,3,4,4,4,3,3,3,3,3,3,1,3,3,2,2,2,1,3,3,4,4,4,1,3,3,2,2,2,1,3,3,4,4,4,1,3,3,4,4,4,1,3,3,2,2,2,1,3,3,4,4,4,1,3,3,2,2,2,1,3,3,4,4,4,1,3,3,2,2,2,1,3,3,2,2,2,1,3,3,4,4,4,1,3,3,2,2,2,1,3,3,4,4,4,1,3,3,4,4,4,1,3,3,4,4,4,1,3,3,4,4,4,1,3,3,4,4,4,1,3,3,4,4,4,1,3,3,2,2,2,1,3,4,4,4,1,3,3,4,4,4,1,3,3,4,4,4,1,3,3,2,2,2,1,3,3,4,4,4,1,3,3,4,4,4,1,3,3,4,4,4,1,3,3,4,4,4,1,3,3,3,3,3,1,3,3,4,4,4,1,3,3,4,4,4,1,3,3,4,4,4,1,3,3,3,3,3,1,3,3,2,2,2,1,3,3,3,3,3,1,3,3,2,2,2,1,3,3,2,2,2,1,3,3,2,2,2,1,3,3,4,4,4,1,3,3,2,2,2,1,3,3,4,4,4,1,3,3,2,2,2,
         1,4,3,2,2,2,2,2,2,2,2,2,1,4,3,2,2,2,1,4,3,2,2,2,1,4,3,2,2,2,1,4,3,2,2,2,1,4,3,2,2,2,1,4,3,2,2,2,1,4,3,2,2,2,1,4,3,2,2,2,1,4,3,2,2,2,1,4,3,2,2,2,1,4,3,2,2,2,1,4,3,2,2,2,1,4,3,2,2,2,1,4,3,2,2,2,1,4,3,2,2,2,1,4,3,2,2,2,1,4,3,2,2,2,1,4,3,2,2,2,1,4,3,2,2,2,1,4,3,2,2,2,1,4,2,2,2,1,4,3,2,2,2,1,4,3,2,2,2,1,4,3,2,2,2,1,4,3,2,2,2,1,4,3,2,2,2,1,4,3,2,2,2,1,4,3,2,2,2,1,4,3,2,2,2,1,4,3,2,2,2,1,4,3,2,2,2,1,4,3,2,2,2,1,4,3,2,2,2,1,4,3,2,2,2,1,4,3,2,2,2,1,4,3,2,2,2,1,4,3,2,2,2,1,4,3,2,2,2,1,4,3,2,2,2,1,4,3,2,2,2,1,4,3,2,2,2,1,4,3,2,2,2)
cl5 <- c(3,5,2,1,1,1,5,5,2,5,5,5,3,5,2,4,4,4,3,5,2,1,1,1,3,5,2,4,4,4,3,5,2,1,1,1,3,5,2,1,1,1,3,5,2,4,4,4,3,5,2,1,1,1,3,5,2,4,4,4,3,5,2,1,1,1,3,5,2,4,4,4,3,5,2,4,4,4,3,5,2,1,1,1,3,5,2,4,4,4,3,5,2,1,1,1,3,5,2,1,1,1,3,5,2,1,1,1,3,5,2,1,1,1,3,5,2,1,1,1,3,5,2,1,1,1,3,5,2,4,4,4,3,5,1,1,1,3,5,2,1,1,1,3,5,2,1,1,1,3,5,2,4,4,4,3,5,2,1,1,1,3,5,2,1,1,1,3,5,2,1,1,1,3,5,2,1,1,1,3,5,2,2,2,2,3,5,2,1,1,1,3,5,2,1,1,1,3,5,2,1,1,1,3,5,2,2,2,2,3,5,2,4,4,4,3,5,2,2,2,2,3,5,2,4,4,4,3,5,2,4,4,4,3,5,2,4,4,4,3,5,2,1,1,1,3,5,2,4,4,4,3,5,2,1,1,1,3,5,2,4,4,4,
         5,1,3,2,2,2,4,4,4,4,4,2,5,1,3,2,2,2,5,1,3,2,2,2,5,1,3,4,4,4,5,1,3,2,2,2,5,1,3,4,4,4,5,1,3,2,2,2,5,1,3,2,2,2,5,1,3,4,4,4,5,1,3,2,2,2,5,1,3,4,4,4,5,1,3,4,4,4,5,1,3,2,2,2,5,1,3,2,2,2,5,1,3,2,2,2,5,1,3,4,4,4,5,1,3,2,2,2,5,1,3,4,4,4,5,1,3,2,2,2,5,1,3,2,2,2,5,1,3,4,4,4,5,1,2,2,2,5,1,3,2,2,2,5,1,3,2,2,2,5,1,3,2,2,2,5,1,3,4,4,4,5,1,3,2,2,2,5,1,3,2,2,2,5,1,3,2,2,2,5,1,3,4,4,4,5,1,3,2,2,2,4,1,3,2,2,2,5,1,3,2,2,2,5,1,3,4,4,4,5,1,3,4,4,4,5,1,3,4,4,4,5,1,3,4,4,4,5,1,3,4,4,4,5,1,3,4,4,4,5,1,3,4,4,4,5,1,3,2,2,2,5,1,3,4,4,4,5,1,3,2,2,2)
cl6 <- c(5,3,1,4,4,4,3,3,1,3,3,3,5,3,1,2,2,2,5,3,1,4,4,4,5,3,1,2,2,2,5,3,1,4,4,4,5,3,1,4,4,4,5,3,1,6,6,6,5,3,1,4,4,4,5,3,1,2,2,2,5,3,1,4,4,4,5,3,1,2,2,2,5,3,1,2,2,2,5,3,1,4,4,4,5,3,1,2,2,2,5,3,1,4,4,4,5,3,1,4,4,4,5,3,1,4,4,4,5,3,1,4,4,4,5,3,1,4,4,4,5,3,1,4,4,4,5,3,1,2,2,2,5,3,4,4,4,5,3,1,4,4,4,5,3,1,4,4,4,5,3,1,2,2,2,5,3,1,4,4,4,5,3,1,4,4,4,5,3,1,4,4,4,5,3,1,4,4,4,5,3,1,1,1,1,5,3,1,4,4,4,5,3,1,4,4,4,5,3,1,4,4,4,5,3,1,1,1,1,5,3,1,2,2,2,5,3,1,1,1,1,5,3,1,2,2,2,5,3,1,2,2,2,5,3,1,2,2,2,5,3,1,4,4,4,5,3,1,6,6,6,5,3,1,4,4,4,5,3,1,2,2,2,
         1,5,2,3,3,3,6,6,3,3,3,3,1,5,2,4,4,4,1,5,2,4,4,4,1,5,2,3,3,3,1,5,2,3,3,3,1,5,2,3,3,3,1,5,2,4,4,4,1,5,2,3,3,3,1,5,2,6,6,6,1,5,2,3,3,3,1,5,2,6,6,6,1,5,2,4,4,4,1,5,2,3,3,3,1,5,2,4,4,4,1,5,2,3,3,3,1,5,2,3,3,3,1,5,2,3,3,3,3,5,2,3,3,3,1,5,2,3,3,3,1,5,2,3,3,3,1,5,2,6,6,6,1,5,3,3,3,1,5,2,3,3,3,1,5,2,4,4,4,1,5,2,4,4,4,1,5,2,3,3,3,1,5,2,3,3,3,1,5,2,3,3,3,1,5,2,4,4,4,1,5,2,6,6,3,1,5,2,3,3,4,6,5,2,4,4,4,1,5,2,4,4,4,1,5,2,3,6,3,1,5,2,6,6,6,1,5,2,3,3,3,1,5,2,6,6,6,1,5,2,6,6,6,1,5,2,6,6,6,1,5,2,3,3,3,1,5,2,4,4,4,1,5,2,3,6,6,1,5,2,4,4,4)
cl7 <- c(1,2,4,6,6,6,2,2,4,2,2,2,1,2,4,7,7,7,1,2,4,6,6,6,1,2,4,3,3,3,1,2,4,6,6,6,1,2,4,6,6,6,1,2,4,5,5,5,1,2,4,6,6,6,1,2,4,3,3,3,1,2,4,6,6,6,1,2,4,3,3,3,1,2,4,7,7,7,1,2,4,6,6,6,1,2,4,7,7,7,1,2,4,6,6,6,1,2,4,6,6,6,1,2,4,6,6,6,1,2,4,6,6,6,1,2,4,6,6,6,1,2,4,6,6,6,1,2,4,3,3,3,1,2,6,6,6,1,2,4,6,6,6,1,2,4,6,6,6,1,2,4,7,7,7,1,2,4,6,6,6,1,2,4,6,6,6,1,2,4,6,6,6,1,2,4,6,6,6,1,2,4,7,7,7,1,2,4,6,6,6,1,2,4,6,6,6,1,2,4,6,6,6,1,2,4,7,7,7,1,2,4,3,3,3,1,2,4,7,7,7,1,2,4,3,3,3,1,2,4,3,3,3,1,2,4,3,3,3,1,2,4,6,6,6,1,2,4,5,5,5,1,2,4,6,6,6,1,2,4,7,7,7,
         7,4,1,3,3,3,2,2,5,3,3,3,7,4,1,2,2,2,7,4,1,5,5,5,7,4,1,5,5,5,7,4,1,3,3,3,7,4,1,5,5,5,7,4,1,2,2,2,7,4,1,3,3,3,7,4,1,6,6,6,7,4,1,3,3,3,7,4,1,6,6,6,7,4,1,2,2,2,7,4,1,3,3,3,7,4,1,2,2,2,7,4,1,3,3,3,7,4,1,3,3,3,7,4,1,5,5,5,3,3,1,3,3,3,7,4,1,3,3,3,7,4,1,3,3,3,7,4,1,6,6,6,7,4,5,5,5,7,4,1,3,3,3,7,4,1,5,5,5,7,4,1,2,2,2,7,4,1,5,5,5,7,4,1,3,3,3,7,4,1,3,3,3,7,4,1,5,5,5,7,4,1,3,3,3,7,4,1,5,5,5,2,4,1,2,2,2,7,4,1,5,5,5,7,4,1,3,3,3,7,4,1,6,6,6,7,4,1,3,3,3,7,4,1,6,6,6,7,4,1,6,6,6,7,4,1,6,6,6,7,4,1,3,3,3,7,4,1,2,2,2,7,4,1,5,6,6,7,4,1,2,2,2)
cl8 <- c(3,5,1,7,7,7,5,5,1,5,5,5,3,5,1,2,2,2,3,5,1,7,7,7,3,5,1,2,2,2,3,5,1,7,7,7,3,5,1,7,7,7,3,5,1,4,4,4,3,5,1,7,7,7,3,5,1,8,8,8,3,5,1,7,7,7,3,5,1,8,8,8,3,5,1,2,2,2,3,5,1,7,7,7,3,5,1,2,2,2,3,5,1,7,7,7,3,5,1,7,7,7,3,5,1,7,7,7,3,5,1,7,7,7,3,5,1,7,7,7,3,5,1,7,7,7,3,5,1,8,8,8,3,5,7,7,7,3,5,1,7,7,7,3,5,1,7,7,7,3,5,1,2,2,2,3,5,1,7,7,7,3,5,1,7,7,7,3,5,1,7,7,7,3,5,1,7,7,7,3,5,1,6,6,6,3,5,1,7,7,7,3,5,1,7,7,7,3,5,1,7,7,7,3,5,1,6,6,6,3,5,1,8,8,8,3,5,1,6,6,6,3,5,1,8,8,8,3,5,1,8,8,8,3,5,1,8,8,8,3,5,1,7,7,7,3,5,1,4,4,4,3,5,1,7,7,7,3,5,1,2,2,2,
         8,6,2,4,4,4,7,7,4,7,7,7,8,6,2,3,3,3,8,6,2,5,5,5,8,6,2,5,5,5,8,6,2,4,4,4,8,6,2,7,7,7,8,6,2,3,3,3,8,6,2,4,4,4,8,6,2,1,1,1,8,6,2,4,4,4,8,6,2,1,1,1,8,6,2,3,3,3,8,6,2,7,7,7,8,6,2,3,3,3,8,6,2,4,4,4,8,6,2,7,7,7,8,6,2,5,5,5,7,7,7,7,7,7,8,6,2,4,4,4,8,6,2,4,4,4,8,6,2,1,1,1,8,6,5,5,5,8,6,2,4,4,4,8,6,2,5,5,5,8,6,2,3,3,3,8,6,2,7,7,7,8,6,2,4,4,4,8,6,2,4,4,4,8,6,2,5,5,5,8,6,2,4,4,4,8,6,2,5,5,5,3,6,2,3,3,3,8,6,2,5,5,5,8,6,2,4,4,4,8,6,2,1,1,1,8,6,2,4,4,4,8,6,2,1,1,1,8,6,2,1,1,1,8,6,2,1,1,1,8,6,2,4,4,4,8,6,2,3,3,3,8,6,2,7,1,1,8,6,2,3,3,3)
cl9 <- c(7,6,9,4,4,4,6,6,9,6,6,6,7,6,9,8,8,8,7,6,9,4,4,4,7,6,9,1,1,1,7,6,9,4,4,4,7,6,9,4,4,4,7,6,9,2,2,2,7,6,9,4,4,4,7,6,9,5,5,5,7,6,9,4,4,4,7,6,9,5,5,5,7,6,9,8,8,8,7,6,9,4,4,4,7,6,9,8,8,8,7,6,9,4,4,4,7,6,9,4,4,4,7,6,9,4,4,4,7,6,9,4,4,4,7,6,9,4,4,4,7,6,9,4,4,4,7,6,9,5,5,5,7,6,4,4,4,7,6,9,4,4,4,7,6,9,4,4,4,7,6,9,8,8,8,7,6,9,4,4,4,7,6,9,4,4,4,7,6,9,4,4,4,7,6,9,4,4,4,7,6,9,3,3,3,7,6,9,4,4,4,7,6,9,4,4,4,7,6,9,4,4,4,7,6,9,3,3,3,7,6,9,5,5,5,7,6,9,3,3,3,7,6,9,5,5,5,7,6,9,5,5,5,7,6,9,5,5,5,7,6,9,4,4,4,7,6,9,2,2,2,7,6,9,4,4,4,7,6,9,8,8,8,
         8,7,4,6,6,6,3,3,6,3,3,3,8,9,4,5,5,5,8,7,4,1,1,1,8,7,4,1,1,1,8,7,4,6,6,6,8,7,4,3,3,3,8,7,4,5,5,5,8,7,4,6,6,6,8,7,4,2,2,2,8,7,4,6,6,6,8,7,4,2,2,2,8,9,4,5,5,5,8,7,4,3,3,3,8,7,4,5,5,5,8,7,4,6,6,6,8,7,4,3,3,3,8,9,4,1,1,1,3,9,3,3,3,3,8,7,4,6,6,6,8,9,4,6,6,6,8,7,4,2,2,2,8,7,1,1,1,8,9,4,6,6,6,8,9,4,1,1,1,8,9,4,5,5,5,8,9,4,3,3,3,8,9,4,6,6,6,8,7,4,6,6,6,8,9,4,1,1,1,8,7,4,6,6,6,8,9,4,1,1,1,5,9,4,5,5,5,8,9,4,1,1,1,8,9,4,6,6,6,8,9,4,2,2,2,8,9,4,6,6,6,8,9,4,2,2,2,8,7,4,2,2,2,8,7,4,2,2,2,8,7,4,6,6,6,8,7,4,5,5,5,8,9,4,3,2,2,8,7,4,5,5,5)
cl10 <- c(4,8,3,10,10,10,8,8,3,8,8,8,4,8,3,2,2,2,4,8,3,7,7,7,4,8,3,5,5,5,4,8,3,10,10,10,4,8,3,7,7,7,4,8,3,1,1,1,4,8,3,10,10,10,4,8,3,9,9,9,4,8,3,10,10,10,4,8,3,9,9,9,4,8,3,2,2,2,4,8,3,10,10,10,4,8,3,2,2,2,4,8,3,10,10,10,4,8,3,10,10,10,4,8,3,7,7,7,4,8,3,7,7,7,4,8,3,10,10,10,4,8,3,10,10,10,4,8,3,9,9,9,4,8,7,7,7,4,8,3,10,10,10,4,8,3,7,7,7,4,8,3,2,2,2,4,8,3,7,7,7,4,8,3,10,10,10,4,8,3,10,10,10,4,8,3,7,7,7,4,8,3,6,6,6,4,8,3,7,7,7,4,8,3,10,10,10,4,8,3,7,7,7,4,8,3,6,6,6,4,8,3,9,9,9,4,8,3,6,6,6,4,8,3,9,9,9,4,8,3,9,9,9,4,8,3,9,9,9,4,8,3,10,10,10,4,8,3,1,1,1,4,8,3,7,7,7,4,8,3,2,2,2,
          7,9,4,10,10,10,8,8,8,1,1,1,7,6,4,5,5,5,7,9,4,3,3,3,7,9,4,3,3,3,7,9,4,10,10,10,7,6,4,1,1,1,7,9,4,5,5,5,7,9,4,10,10,10,7,9,4,2,2,2,7,9,4,10,10,10,7,9,4,2,2,2,7,9,4,5,5,5,7,6,4,1,1,1,7,9,4,5,5,5,7,9,4,10,10,10,7,9,4,1,1,1,7,6,4,3,3,3,1,1,1,1,1,1,7,9,4,10,10,10,7,6,4,10,10,10,7,9,4,2,2,2,7,9,3,3,3,7,6,4,10,10,10,7,6,4,3,3,3,7,6,4,5,5,5,7,6,4,1,1,1,7,6,4,10,10,10,7,9,4,10,8,10,7,6,4,3,3,3,7,9,4,8,8,8,7,6,4,3,3,3,8,6,4,8,8,8,7,6,4,3,3,3,7,9,4,8,8,8,7,6,4,2,2,2,7,6,4,8,8,8,7,6,4,2,2,2,7,9,4,2,2,2,7,9,4,2,2,2,7,9,4,10,8,10,7,9,4,5,5,5,7,6,4,1,2,2,7,9,4,5,5,5)
cl11 <- c(4,3,6,5,5,5,3,3,6,3,3,3,4,3,6,8,8,8,4,3,6,7,7,7,4,3,6,1,1,1,4,3,6,5,5,5,4,3,6,7,7,7,4,3,6,2,2,2,4,3,6,5,5,5,4,3,6,11,11,11,4,3,6,5,5,5,4,3,6,11,11,11,4,3,6,8,8,8,4,3,6,5,5,5,4,3,6,8,8,8,4,3,6,5,5,5,4,3,6,5,5,5,4,3,6,7,7,7,4,3,6,7,7,7,4,3,6,5,5,5,4,3,6,5,5,5,4,3,6,11,11,11,4,3,9,9,9,4,3,6,5,5,5,4,3,6,7,7,7,4,3,6,8,8,8,4,3,6,7,7,7,4,3,6,5,5,5,4,3,6,5,5,5,4,3,6,7,7,7,4,3,6,10,10,10,4,3,6,9,9,9,4,3,6,5,5,5,4,3,6,7,7,7,4,3,6,10,10,10,4,3,6,11,11,11,4,3,6,10,10,10,4,3,6,11,11,11,4,3,6,11,11,11,4,3,6,11,11,11,4,3,6,5,5,5,4,3,6,2,2,2,4,3,6,7,7,7,4,3,6,8,8,8)
cl12 <- c(1,3,9,10,10,10,3,3,9,3,3,3,1,3,9,11,11,11,1,3,9,2,2,2,1,3,9,12,12,12,1,3,9,5,5,5,1,3,9,2,2,2,1,3,9,8,8,8,1,3,9,10,10,10,1,3,9,4,4,4,1,3,9,10,10,10,1,3,9,4,4,4,1,3,9,11,11,11,1,3,9,10,10,10,1,3,9,11,11,11,1,3,9,5,5,5,1,3,9,5,5,5,1,3,9,2,2,2,1,3,9,2,2,2,1,3,9,10,10,10,1,3,9,10,10,10,1,3,9,4,4,4,1,3,7,7,7,1,3,9,10,10,10,1,3,9,2,2,2,1,3,9,11,11,11,1,3,9,2,2,2,1,3,9,5,5,5,1,3,9,10,10,10,1,3,9,2,2,2,1,3,9,6,6,6,1,3,9,7,7,7,1,3,9,10,10,10,1,3,9,2,2,2,1,3,9,6,6,6,1,3,9,4,4,4,1,3,9,6,6,6,1,3,9,4,4,4,1,3,9,4,4,4,1,3,9,4,4,4,1,3,9,10,10,10,1,3,9,8,8,8,1,3,9,2,2,2,1,3,9,11,11,11)
cl13 <- c(2,3,12,13,13,13,3,3,12,3,3,3,2,3,12,11,11,11,2,3,12,8,8,8,2,3,12,4,4,4,2,3,12,1,1,1,2,3,12,8,8,8,2,3,12,6,6,6,2,3,12,13,13,13,2,3,12,5,5,5,2,3,12,13,13,13,2,3,12,5,5,5,2,3,12,11,11,11,2,3,12,13,13,13,2,3,12,11,11,11,2,3,12,1,1,1,2,3,12,1,1,1,2,3,12,8,8,8,2,3,12,8,8,8,2,3,12,13,13,13,2,3,12,13,13,13,2,3,12,5,5,5,2,3,9,9,9,2,3,12,13,13,13,2,3,12,8,8,8,2,3,12,11,11,11,2,3,12,8,8,8,2,3,12,1,1,1,2,3,12,13,13,13,2,3,12,8,8,8,2,3,12,7,7,7,2,3,12,9,9,9,2,3,12,13,13,13,2,3,12,8,8,8,2,3,12,7,7,7,2,3,12,5,5,5,2,3,12,7,7,7,2,3,12,5,5,5,2,3,12,5,5,5,2,3,12,10,10,10,2,3,12,13,13,13,2,3,12,6,6,6,2,3,12,8,8,8,2,3,12,11,11,11)
cl14 <- c(7,8,1,9,9,9,8,8,1,8,8,8,7,8,1,12,12,12,7,8,1,10,10,10,7,8,1,5,5,5,7,8,1,4,4,4,7,8,1,10,10,10,7,8,1,11,11,11,7,8,1,9,9,9,7,8,1,2,2,2,7,8,1,9,9,9,7,8,1,2,2,2,7,8,1,13,13,13,7,8,1,9,9,9,7,8,1,12,12,12,7,8,1,4,4,4,7,8,1,4,4,4,7,8,1,10,10,10,7,8,1,10,10,10,7,8,1,9,9,9,7,8,1,9,9,9,7,8,1,2,2,2,7,8,3,3,3,7,8,1,9,9,9,7,8,1,10,10,10,7,8,1,12,12,12,7,8,1,10,10,10,7,8,1,4,4,4,7,8,1,9,9,9,7,8,1,10,10,10,7,8,1,6,6,6,7,8,1,3,3,3,7,8,1,9,9,9,7,8,1,10,10,10,7,8,1,6,6,6,7,8,1,2,2,2,7,8,1,6,6,6,7,8,1,2,2,2,7,8,1,2,2,2,7,8,1,14,14,14,7,8,1,9,9,9,7,8,1,11,11,11,7,8,1,10,10,10,7,8,1,12,12,12)
cl15 <- c(9,4,8,12,12,12,4,4,8,4,4,4,9,4,8,15,15,15,9,4,8,3,3,3,9,2,8,7,7,7,9,4,8,6,6,6,9,4,8,3,3,3,9,4,8,5,5,5,9,4,8,12,12,12,9,4,8,13,13,13,9,4,8,12,12,12,9,4,8,11,11,11,9,4,8,14,14,14,9,4,8,12,12,12,9,4,8,15,15,15,9,4,8,6,6,6,9,4,8,6,6,6,9,4,8,3,3,3,9,2,8,3,3,3,9,4,8,12,12,12,9,2,8,12,12,12,9,2,8,11,11,11,9,4,1,1,1,9,2,8,12,12,12,9,2,8,3,3,3,9,4,8,15,15,15,9,2,8,3,3,3,9,2,8,6,6,6,9,2,8,12,12,12,9,2,8,3,3,3,9,4,8,10,10,10,9,4,8,1,1,1,9,2,8,12,12,12,9,2,8,3,3,3,9,2,8,10,10,10,9,2,8,11,11,11,9,2,8,10,10,10,9,2,8,11,11,11,9,4,8,11,11,11,9,4,8,13,13,13,9,4,8,12,12,12,9,4,8,5,5,5,9,2,8,3,3,3,9,4,8,15,15,15)
cl16 <- c(15,12,3,9,2,2,12,12,3,12,12,12,15,12,3,16,16,16,15,12,3,4,4,4,15,8,3,5,5,5,11,12,3,14,14,14,15,12,3,4,4,4,15,12,3,7,7,7,11,12,3,9,9,9,15,12,3,1,1,1,11,12,3,9,2,2,15,12,3,1,1,1,11,12,3,10,10,10,15,12,3,9,9,9,15,12,3,16,16,16,15,12,3,14,14,14,11,12,3,14,14,14,15,12,3,4,4,4,15,8,3,4,4,4,15,12,3,9,9,9,15,8,3,9,2,2,15,8,3,1,1,1,15,12,13,13,13,15,8,3,9,9,9,15,8,3,4,4,4,15,12,3,16,16,16,15,8,3,4,4,4,15,8,3,14,14,14,11,8,3,9,9,9,15,8,3,4,4,4,15,12,3,6,6,6,11,12,3,13,13,13,15,8,3,9,9,9,15,8,3,4,4,4,15,8,3,6,6,6,15,8,3,1,1,1,15,8,3,6,6,6,15,8,3,1,1,1,15,12,3,1,1,1,11,12,3,2,2,2,15,12,3,9,9,9,15,12,3,7,7,7,15,8,3,4,4,4,15,12,3,16,16,16)
cl17 <- c(6,5,1,12,16,16,5,5,1,5,5,5,6,5,1,14,14,14,6,5,1,8,8,8,6,2,1,13,13,13,6,5,1,7,7,7,6,5,1,17,17,17,6,5,1,10,10,10,6,5,1,9,9,9,6,5,1,11,11,11,6,5,1,12,16,16,6,5,1,11,11,11,6,5,1,8,8,8,6,5,1,12,12,12,6,5,1,14,14,14,6,5,1,7,7,7,6,5,1,7,7,7,6,5,1,17,17,17,6,2,1,17,17,17,6,5,1,12,12,12,6,2,1,12,16,16,6,2,1,11,11,11,6,5,3,3,3,6,2,1,12,12,12,6,2,1,8,8,8,6,5,1,14,14,14,6,2,1,17,17,17,6,2,1,7,7,7,6,2,1,9,9,9,6,2,1,17,17,17,6,5,1,4,4,4,6,5,1,3,3,3,6,2,1,9,9,9,6,2,1,17,17,17,6,2,1,4,4,4,6,2,1,11,11,11,6,2,1,4,4,4,6,2,1,11,11,11,6,5,1,11,11,11,6,5,1,15,15,15,6,5,1,12,12,12,6,5,1,10,10,10,6,2,1,17,17,17,6,5,1,14,14,14)
cl18 <- c(5,17,7,11,8,8,17,17,7,17,17,17,5,17,7,2,2,2,5,17,7,3,3,3,5,16,7,18,18,18,5,17,7,14,14,14,5,17,7,12,12,12,5,17,7,15,15,15,5,17,7,10,10,10,5,17,7,9,9,9,5,17,7,11,8,8,5,17,7,9,9,9,5,17,7,18,18,18,5,17,7,11,11,11,5,17,7,2,2,2,5,17,7,14,14,14,5,17,7,14,14,14,5,17,7,12,12,12,5,16,7,12,12,12,5,17,7,11,11,11,5,16,7,11,8,8,5,16,7,9,9,9,5,17,1,1,1,5,16,7,11,11,11,5,16,7,3,3,3,5,17,7,2,2,2,5,16,7,12,12,12,5,16,7,14,14,14,5,16,7,10,10,10,5,16,7,12,12,12,5,17,7,6,6,6,5,17,7,1,1,1,5,16,7,10,10,10,5,16,7,12,12,12,5,16,7,6,6,6,5,16,7,9,9,9,5,16,7,13,13,13,5,16,7,9,9,9,5,17,7,9,9,9,5,17,7,4,4,4,5,17,7,11,11,11,5,17,7,15,15,15,5,16,7,12,12,12,5,17,7,2,2,2)
cl19 <- c(4,11,5,12,7,7,11,11,5,11,11,11,4,11,5,1,1,1,4,11,5,2,2,2,4,9,5,6,6,6,4,11,5,3,3,3,4,11,18,8,8,8,4,11,5,13,13,13,4,11,10,15,15,15,4,11,10,14,14,14,4,11,10,12,7,7,4,11,17,14,14,14,4,11,5,6,6,6,4,11,5,12,12,12,4,11,5,1,1,1,4,11,10,3,3,3,4,11,18,3,3,3,4,11,5,8,8,8,4,9,18,8,8,8,4,11,10,15,15,15,4,9,17,12,7,7,4,9,5,14,14,14,4,11,19,19,19,4,9,5,12,12,12,4,9,5,2,2,2,4,11,5,1,1,1,4,9,5,8,8,8,4,9,5,3,3,3,4,9,5,15,15,15,4,9,5,2,2,2,4,11,10,16,16,16,4,11,5,19,19,19,4,9,5,15,15,15,4,9,17,2,2,2,4,9,5,16,16,16,4,9,17,14,14,14,4,9,10,6,6,6,4,9,18,14,14,14,4,11,5,14,14,14,4,11,5,6,6,6,4,11,10,12,12,12,4,11,5,13,13,13,4,9,5,8,8,8,4,11,5,1,1,1)
cl20 <- c(14,17,19,6,18,18,17,17,19,17,17,17,14,17,19,16,16,16,14,17,19,7,7,7,14,20,19,5,5,5,14,17,19,11,11,11,14,17,19,1,1,1,14,17,19,10,10,10,14,17,9,3,3,3,14,17,19,13,13,13,14,17,9,6,18,18,14,17,9,13,13,13,14,17,19,5,5,5,14,17,19,6,6,6,14,17,19,16,16,16,14,17,9,11,11,11,14,17,19,11,11,11,14,17,19,4,4,4,14,20,19,12,12,12,14,17,9,3,3,3,14,20,9,6,18,18,14,20,19,13,13,13,14,17,2,2,2,14,20,19,6,6,6,14,20,19,7,7,7,14,17,19,16,16,16,14,20,19,1,1,1,14,20,19,11,11,11,14,20,19,3,3,3,14,20,19,8,8,8,14,17,19,15,15,15,14,17,19,2,2,2,14,20,19,3,3,3,14,20,9,8,8,8,14,20,19,15,15,15,14,20,9,13,13,13,14,20,9,15,15,15,14,20,19,13,13,13,14,17,19,13,13,13,14,17,19,12,12,12,14,17,9,6,6,6,14,17,19,10,10,10,14,20,19,1,1,1,14,17,19,16,16,16)


every_cl <- list(rep(1, 263), c(1, cl2[2:263]), cl3, cl4, cl5,
                 cl6, cl7, cl8, cl9, cl10, cl11, cl12, cl13, cl14, cl15,
                 cl16, cl17, cl18, cl19, cl20)
vclust1 <- mlcc.reps(march_less, numb.clusters = 1, numb.runs = 30, max.iter = 50,
                     initial.segmentations = list(rep(1, 263)))
vclust2 <- mlcc.reps(march_less, numb.clusters = 2, numb.runs = 30, max.iter = 50,
                     initial.segmentations = list(c(1, cl2[2:263])))
vclust3 <- mlcc.reps(march_less, numb.clusters = 3, numb.runs = 30, max.iter = 50,
                     initial.segmentations = list(cl3[1:263]))
vclust4 <- mlcc.reps(march_less, numb.clusters = 4, numb.runs = 30, max.iter = 50,
                     initial.segmentations = list(cl4[1:263]))
vclust5 <- mlcc.reps(march_less, numb.clusters = 5, numb.runs = 30, max.iter = 50,
                     initial.segmentations = list(cl5[1:263]))
vclust6 <- mlcc.reps(march_less, numb.clusters = 6, numb.runs = 30, max.iter = 50,
                     initial.segmentations = list(cl6[1:263]))
vclust7 <- mlcc.reps(march_less, numb.clusters = 7, numb.runs = 30, max.iter = 50,
                     initial.segmentations = list(cl7[1:263]))
vclust8 <- mlcc.reps(march_less, numb.clusters = 8, numb.runs = 30, max.iter = 50,
                     initial.segmentations = list(cl8[1:263]))
vclust9 <- mlcc.reps(march_less, numb.clusters = 9, numb.runs = 30, max.iter = 50,
                     initial.segmentations = list(cl9[1:263]))
vclust10 <- mlcc.reps(march_less, numb.clusters = 10, numb.runs = 30, max.iter = 50,
                     initial.segmentations = list(cl10[1:263]))
vclust11 <- mlcc.reps(march_less, numb.clusters = 11, numb.runs = 30, max.iter = 50,
                      initial.segmentations = list(cl11))
vclust12 <- mlcc.reps(march_less, numb.clusters = 12, numb.runs = 30, max.iter = 50,
                      initial.segmentations = list(cl12))
vclust13 <- mlcc.reps(march_less, numb.clusters = 13, numb.runs = 30, max.iter = 50,
                      initial.segmentations = list(cl13))
vclust14 <- mlcc.reps(march_less, numb.clusters = 14, numb.runs = 30, max.iter = 50,
                      initial.segmentations = list(cl14))
vclust15 <- mlcc.reps(march_less, numb.clusters = 15, numb.runs = 30, max.iter = 50,
                      initial.segmentations = list(cl15))
vclust16 <- mlcc.reps(march_less, numb.clusters = 16, numb.runs = 30, max.iter = 50,
                      initial.segmentations = list(cl16))
vclust17 <- mlcc.reps(march_less, numb.clusters = 17, numb.runs = 30, max.iter = 50,
                      initial.segmentations = list(cl17))
vclust18 <- mlcc.reps(march_less, numb.clusters = 18, numb.runs = 30, max.iter = 50,
                      initial.segmentations = list(cl18))
vclust19 <- mlcc.reps(march_less, numb.clusters = 19, numb.runs = 30, max.iter = 50,
                      initial.segmentations = list(cl19))
vclust20 <- mlcc.reps(march_less, numb.clusters = 20, numb.runs = 30, max.iter = 50,
                      initial.segmentations = list(cl20))

every_vcl <- list(vclust1, vclust2, vclust3, vclust4, vclust5,
                  vclust6, vclust7, vclust8, vclust9, vclust10,
                  vclust11, vclust12, vclust13, vclust14, vclust15,
                  vclust16, vclust17, vclust18, vclust19, vclust20)
lapply(every_vcl, function(x) x$BIC)
# The biggest BIC: 19 clusters
clusters_ssc19 <- print.clusters.vec(march_less, cl19)
clusters_vcl9 <- print.clusters(march_less, vclust19)
sum(clusters_ssc19 == clusters_vcl9) # żadnych zmian
# A jak dla innych?
lapply(1:20, function(x) {
  cl_ssc <- print.clusters.vec(march_less, (every_cl[[x]])[1:263])
  cl_vcl <- print.clusters(march_less, every_vcl[[x]])
  if(all(dim(cl_ssc) == dim(cl_vcl))) {
    sum(cl_ssc == cl_vcl)/(nrow(cl_ssc)*ncol(cl_ssc))
  } else {
    "Diff dim"
  }
})
# Tylko tutaj zaszły zmiany
cl_ssc2 <- print.clusters.vec(march_less, (every_cl[[2]])[1:263])
cl_vcl2 <- print.clusters(march_less, every_vcl[[2]])
# draw.map(every_cl[[2]]][1:263])
cl_ssc3 <- print.clusters.vec(march_less, (every_cl[[3]])[1:263])
cl_vcl3 <- print.clusters(march_less, every_vcl[[3]])

draw.map(vclust8$segmentation, clusters = c(2, 4, 6, 7, 8))
print.clusters(march_less, vclust8)

print.clusters(march_less, vclust10)
draw.map(vclust10$segmentation, clusters = c(1:2, 5:7, 9:10))
